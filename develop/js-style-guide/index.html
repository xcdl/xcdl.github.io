<!doctype html>
<html>

<head>

  <meta charset='utf-8'>
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>JavaScript Style Guide</title>
  <meta name="description" content="The xPack eXtensible Component Definition Language framework">

  <meta property="og:title" content="JavaScript Style Guide" />
  <meta property="og:site_name" content="xPack / XCDL" />

  <link rel="alternate" type="application/rss+xml" title="xPack / XCDL" href="/feed.xml" />








  <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" type="text/css" href="/stylesheets/screen.css?20170326122230" media="screen">
  <link rel="stylesheet" type="text/css" href="/stylesheets/print.css?20170326122230" media="print">

  <link rel="canonical" href="/develop/js-style-guide/">



  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-16767008-13', 'auto');
  ga('send', 'pageview');

</script>



</head>


<body>

<div class="container">

  <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.4";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

  <script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));</script>

  <div class="site-header">
  <img alt="Icon" class="site-icon" src="/assets/icons/components.png" height="100" width="100">
  <div class="site-title">
    <h1><a href="/">xPack / XCDL</a></h1>
    <p>The xPack eXtensible Component Definition Language framework</p>
  </div>
</div>


</div>

<div class="container">

  <div class="wrapper">
    <div class="site-body">

      <div class="site-sidebar">


  <div class="custom-sidebar">
    <div class="boxed-group-inner">
      <h4 id="news"><a href="/blog/">News</a></h4>

<ul>
  <li><a href="/blog/2016/08/04/license-update/">License changed from LGPL to MIT License</a></li>
  <li><a href="/blog/2015/10/12/github-pages/">The GitHub Wiki content was migrated to GitHub Pages</a></li>
  <li><a href="/blog/2015/09/26/github-wiki/">The XCDL Wiki content was migrated from MediaWiki to GitHub Wiki</a></li>
</ul>


    </div>
  </div>


  <div class="custom-sidebar">
    <div class="boxed-group-inner">
      <h4 id="home"><a href="/">Home</a></h4>

<h4 id="component-writers-guide">Component Writer’s Guide</h4>
<ul>
  <li><a href="/guide/rationals/">Rationals</a></li>
  <li><a href="/guide/concepts/">Concepts</a></li>
  <li><a href="/guide/packages/">Packages</a></li>
  <li><a href="/guide/repositories/">Repositories</a></li>
  <li><a href="/guide/metadata/">Metadata</a></li>
  <li><a href="/guide/build/">Build</a></li>
  <li><a href="/guide/build-process/">More build</a></li>
</ul>

<h4 id="reference">Reference</h4>
<ul>
  <li><a href="/reference/metadata/">Metadata</a></li>
</ul>

<h4 id="license">License</h4>

<ul>
  <li><a href="https://opensource.org/licenses/MIT">MIT</a></li>
</ul>

<h4 id="about"><a href="/about/">About</a></h4>

    </div>
  </div>

  <div class="site-theme">
    This site uses the <a href="https://github.com/ilg-ul/github-jekyll-theme">GitHub Wiki-like</a> theme by <a href="https://github.com/ilg-ul">Liviu Ionescu</a>.
  </div>

</div>


      <div class="site-content">

        
<h1 class="page-title">JavaScript Style Guide</h1>
<p class="last-modified">Last modified on Mon Mar 27 19:46:14 2017 UTC.</p>


<div id="toc-container">
<table class="toc" id="toc">
<tbody>
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toc_level-1 toc_section-1">
<a href="#from-understanding-ecmascript-6"><span class="tocnumber">1</span> <span class="toctext">From Understanding ECMAScript 6</span></a>
<ul>
<li class="toc_level-2 toc_section-2">
<a href="#block-bindings"><span class="tocnumber">1.1</span> <span class="toctext">Block bindings</span></a>
</li>
<li class="toc_level-2 toc_section-3">
<a href="#functions"><span class="tocnumber">1.2</span> <span class="toctext">Functions</span></a>
</li>
<li class="toc_level-2 toc_section-4">
<a href="#enhanced-object-functionality"><span class="tocnumber">1.3</span> <span class="toctext">Enhanced Object Functionality</span></a>
</li>
</ul>
</li>
<li class="toc_level-1 toc_section-5">
<a href="#from-npms-funny-coding-style"><span class="tocnumber">2</span> <span class="toctext">From npm’s “funny” coding style</span></a>
<ul>
<li class="toc_level-2 toc_section-6">
<a href="#line-length"><span class="tocnumber">2.1</span> <span class="toctext">Line length</span></a>
</li>
<li class="toc_level-2 toc_section-7">
<a href="#indentation"><span class="tocnumber">2.2</span> <span class="toctext">Indentation</span></a>
</li>
<li class="toc_level-2 toc_section-8">
<a href="#curly-braces"><span class="tocnumber">2.3</span> <span class="toctext">Curly braces</span></a>
</li>
<li class="toc_level-2 toc_section-9">
<a href="#semicolons"><span class="tocnumber">2.4</span> <span class="toctext">Semicolons</span></a>
</li>
<li class="toc_level-2 toc_section-10">
<a href="#comma-first"><span class="tocnumber">2.5</span> <span class="toctext">Comma first</span></a>
</li>
<li class="toc_level-2 toc_section-11">
<a href="#quotes"><span class="tocnumber">2.6</span> <span class="toctext">Quotes</span></a>
</li>
<li class="toc_level-2 toc_section-12">
<a href="#whitespaces"><span class="tocnumber">2.7</span> <span class="toctext">Whitespaces</span></a>
</li>
<li class="toc_level-2 toc_section-13">
<a href="#functions-1"><span class="tocnumber">2.8</span> <span class="toctext">Functions</span></a>
</li>
<li class="toc_level-2 toc_section-14">
<a href="#case-naming-etc"><span class="tocnumber">2.9</span> <span class="toctext">Case, naming, etc</span></a>
</li>
<li class="toc_level-2 toc_section-15">
<a href="#null-undefined-false"><span class="tocnumber">2.10</span> <span class="toctext">null, undefined, false</span></a>
</li>
<li class="toc_level-2 toc_section-16">
<a href="#exceptions"><span class="tocnumber">2.11</span> <span class="toctext">Exceptions</span></a>
</li>
</ul>
</li>
<li class="toc_level-1 toc_section-17">
<a href="#from-nodejs-modules"><span class="tocnumber">3</span> <span class="toctext">From Node.js modules</span></a>
<ul>
<li class="toc_level-2 toc_section-18">
<a href="#modules"><span class="tocnumber">3.1</span> <span class="toctext">Modules</span></a>
</li>
<li class="toc_level-2 toc_section-19">
<a href="#caching"><span class="tocnumber">3.2</span> <span class="toctext">Caching</span></a>
</li>
<li class="toc_level-2 toc_section-20">
<a href="#exports"><span class="tocnumber">3.3</span> <span class="toctext">Exports</span></a>
</li>
<li class="toc_level-2 toc_section-21">
<a href="#accessing-the-main-module"><span class="tocnumber">3.4</span> <span class="toctext">Accessing the main module</span></a>
</li>
<li class="toc_level-2 toc_section-22">
<a href="#the-module-wrapper"><span class="tocnumber">3.5</span> <span class="toctext">The module wrapper</span></a>
</li>
<li class="toc_level-2 toc_section-23">
<a href="#global-objects"><span class="tocnumber">3.6</span> <span class="toctext">Global objects</span></a>
</li>
</ul>
</li>
<li class="toc_level-1 toc_section-24">
<a href="#the-xpack-project-preferences"><span class="tocnumber">4</span> <span class="toctext">The xPack project preferences</span></a>
<ul>
<li class="toc_level-2 toc_section-25">
<a href="#prefer-es6-solutions"><span class="tocnumber">4.1</span> <span class="toctext">Prefer ES6 solutions</span></a>
</li>
<li class="toc_level-2 toc_section-26">
<a href="#use-classes-as-much-as-possible"><span class="tocnumber">4.2</span> <span class="toctext">Use classes as much as possible</span></a>
</li>
<li class="toc_level-2 toc_section-27">
<a href="#use-promises-instead-of-callbacks"><span class="tocnumber">4.3</span> <span class="toctext">Use promises instead of callbacks</span></a>
</li>
<li class="toc_level-2 toc_section-28">
<a href="#use-asyncawait-for-anynchronous-calls"><span class="tocnumber">4.4</span> <span class="toctext">Use async/await for anynchronous calls</span></a>
</li>
<li class="toc_level-2 toc_section-29">
<a href="#use-static-class-members-for-sharing"><span class="tocnumber">4.5</span> <span class="toctext">Use static class members for sharing</span></a>
</li>
<li class="toc_level-2 toc_section-30">
<a href="#do-not-restrict-export-to-a-single-function-or-class"><span class="tocnumber">4.6</span> <span class="toctext">Do not restrict export to a single function or class</span></a>
</li>
<li class="toc_level-2 toc_section-31">
<a href="#prefer-static-classes-to-group-methods"><span class="tocnumber">4.7</span> <span class="toctext">Prefer static classes to group methods</span></a>
</li>
</ul>
</li>
<li class="toc_level-1 toc_section-32">
<a href="#make-node-exportsimports-look-like-es6-exportsimports"><span class="tocnumber">5</span> <span class="toctext">Make node exports/imports look like ES6 exports/imports</span></a>
</li>
<li class="toc_level-1 toc_section-33">
<a href="#links-to-other-style-guides"><span class="tocnumber">6</span> <span class="toctext">Links to other style guides</span></a>
</li>
<li class="toc_level-1 toc_section-34">
<a href="#linting-tools"><span class="tocnumber">7</span> <span class="toctext">Linting Tools</span></a>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div><p>After many years dealing with style guides for various languages, the conclusion is that the style itself is less important than applying it consistently.</p>

<p>So, for the xPack JavaScript source files to be consistent, the first requirement is to pass the <a href="https://standardjs.com">Standard JS</a> validation tools.</p>

<p>After this, the main recommendations are:</p>

<ul>
  <li>use the <strong>ECMAScript 6</strong> specifications (ES 6),</li>
  <li>if the module does something reasonably complex, the module public functions <strong>must be asyncronous</strong>,</li>
  <li>asynchronous functions must <strong>use promises</strong> (and definitely <strong>avoid callbacks</strong>),</li>
  <li><strong>reentrancy</strong> should be seriously considered (avoid module-global variables).</li>
</ul>

<div style="clear: both;"></div>

<h2 id="from-understanding-ecmascript-6">From <em>Understanding ECMAScript 6</em></h2>

<p>The main specifications to be followed are those of ES 6; they override all other older specifications and style guides.</p>

<h3 id="block-bindings">Block bindings</h3>

<p>Use <code class="highlighter-rouge">const</code> by default, and only use <code class="highlighter-rouge">let</code> when you know a variable’s value needs to change</p>

<h3 id="functions">Functions</h3>

<p>Use default parameters.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">makeRequest</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">timeout</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span> <span class="nx">callback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{})</span> <span class="p">{</span>
  <span class="c1">// the rest of the function</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">second</span> <span class="o">=</span> <span class="nx">getValue</span><span class="p">(</span><span class="nx">first</span><span class="p">))</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">first</span> <span class="o">+</span> <span class="nx">second</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Use <em>rest</em> parameters.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">pick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">object</span><span class="p">,</span> <span class="p">...</span><span class="nx">keys</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">result</span><span class="p">[</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">object</span><span class="p">[</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">result</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge">Function</code> constructor.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">add</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Function</span><span class="p">(</span><span class="s2">"first"</span><span class="p">,</span> <span class="s1">'second = first'</span><span class="p">,</span>
                 <span class="s1">'return first + second'</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>     <span class="c1">// 2</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">add</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>        <span class="c1">// 2</span>
</code></pre>
</div>

<p>JavaScript has two different internal-only methods for functions: <code class="highlighter-rouge">[[Call]]</code> and <code class="highlighter-rouge">[[Construct]]</code>. When a function is called without new, the <code class="highlighter-rouge">[[Call]]</code> method is executed, which executes the body of the function as it appears in the code. When a function is called with new, that’s when the <code class="highlighter-rouge">[[Construct]]</code> method
is called. The <code class="highlighter-rouge">[[Construct]]</code> method is responsible for creating a new object, called the instance, and then executing the function body with this set to the instance. Functions that have a <code class="highlighter-rouge">[[Construct]]</code> method are called constructors.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">Person</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="k">instanceof</span> <span class="nx">Person</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">'You must use new with Person.'</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="s1">'Nicholas'</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">notAPerson</span> <span class="o">=</span> <span class="nx">Person</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span> <span class="s1">'Michael'</span><span class="p">)</span>    <span class="c1">// works!</span>
</code></pre>
</div>

<p>Block-level functions</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="s1">'use strict'</span>

<span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">doSomething</span><span class="p">)</span> <span class="c1">// throws an error</span>
  <span class="kd">let</span> <span class="nx">doSomething</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// empty</span>
  <span class="p">}</span>
  <span class="nx">doSomething</span><span class="p">()</span>
<span class="p">}</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">doSomething</span><span class="p">)</span>
</code></pre>
</div>

<p>Arrow functions are functions defined with a new syntax that uses an arrow (<code class="highlighter-rouge">=&gt;</code>)</p>

<ul>
  <li><strong>No this, super, arguments, and new.target bindings</strong> The values of <code class="highlighter-rouge">this</code>, <code class="highlighter-rouge">super</code>, arguments, and new.target inside the function are defined by the closest containing non-arrow function</li>
  <li><strong>Cannot be called with new</strong> Arrow functions do not have a [[Construct]] method and therefore cannot be used as constructors. Arrow functions throw an error when used with new.</li>
  <li><strong>No prototype</strong> Because you can’t use new on an arrow function, there’s no need for a prototype. The prototype property of an arrow function doesn’t exist.</li>
  <li><strong>Can’t change this</strong> The value of this inside the function can’t be changed. It remains the same throughout the entire life cycle of the function.</li>
  <li><strong>No arguments object</strong> Because arrow functions have no arguments binding, you must rely on named and rest parameters to access function arguments.</li>
  <li><strong>No duplicate named parameters</strong> Arrow functions cannot have duplicate named parameters in strict or non-strict mode, as opposed to non-arrow functions, which cannot have duplicate named parameters only in strict mode.</li>
</ul>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">sum</span> <span class="o">=</span> <span class="p">(</span><span class="nx">num1</span><span class="p">,</span> <span class="nx">num2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">num1</span> <span class="o">+</span> <span class="nx">num2</span>
<span class="c1">// effectively equivalent to:</span>
<span class="kd">let</span> <span class="nx">sum</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">num1</span><span class="p">,</span> <span class="nx">num2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">num1</span> <span class="o">+</span> <span class="nx">num2</span>
<span class="p">};</span>
</code></pre>
</div>

<h3 id="enhanced-object-functionality">Enhanced Object Functionality</h3>

<p>It’s now possible to modify an object’s prototype after it’s been created thanks to ECMAScript 6’s <code class="highlighter-rouge">Object.setPrototypeOf()</code> method.</p>

<p>In addition, you can use the <code class="highlighter-rouge">super</code> keyword to call methods on an object’s prototype. The <code class="highlighter-rouge">this</code> binding inside a method invoked using <code class="highlighter-rouge">super</code> is set up to automatically work with the current value of <code class="highlighter-rouge">this</code>.</p>

<h2 id="from-npms-funny-coding-style">From <a href="https://docs.npmjs.com/misc/coding-style"><em>npm’s “funny” coding style</em></a></h2>

<p>As the name implies, some of them are <em>funny</em>, but some are still useful.</p>

<h3 id="line-length">Line length</h3>

<p>Keep lines shorter than <strong>80</strong> characters</p>

<h3 id="indentation">Indentation</h3>

<p>Indentation is <strong>two spaces</strong></p>

<h3 id="curly-braces">Curly braces</h3>

<p>Curly braces belong on the same line</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">while</span> <span class="p">(</span><span class="nx">foo</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">bar</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h3 id="semicolons">Semicolons</h3>

<p>Don’t use semicolons, except when required; for example to prevent the expression from being interpreted as a function call or property access, respectively.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="p">;(</span><span class="nx">x</span> <span class="o">||</span> <span class="nx">y</span><span class="p">).</span><span class="nx">doSomething</span><span class="p">()</span>
<span class="p">;[</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">].</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">doSomething</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="comma-first">Comma first</h3>

<p>Put the <strong>comma at the start</strong> of the next line, directly below the token that starts the list</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">magicWords</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">'abracadabra'</span>
                 <span class="p">,</span> <span class="s1">'gesundheit'</span>
                 <span class="p">,</span> <span class="s1">'ventrilo'</span>
                 <span class="p">]</span>
  <span class="p">,</span> <span class="nx">spells</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">'fireball'</span> <span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">setOnFire</span><span class="p">()</span> <span class="p">}</span>
             <span class="p">,</span> <span class="s1">'water'</span> <span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">putOut</span><span class="p">()</span> <span class="p">}</span>
             <span class="p">}</span>
  <span class="p">,</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="p">,</span> <span class="nx">b</span> <span class="o">=</span> <span class="s1">'abc'</span>
  <span class="p">,</span> <span class="nx">etc</span>
  <span class="p">,</span> <span class="nx">somethingElse</span>
</code></pre>
</div>

<h3 id="quotes">Quotes</h3>

<p>Use single quotes for strings except to avoid escaping</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">ok</span> <span class="o">=</span> <span class="s1">'String contains "double" quotes'</span>
<span class="kr">const</span> <span class="nx">alsoOk</span> <span class="o">=</span> <span class="s2">"String contains 'single' quotes or apostrophe"</span>
<span class="kr">const</span> <span class="nx">paramOk</span> <span class="o">=</span> <span class="err">`</span><span class="nx">Back</span> <span class="nx">quotes</span> <span class="nx">string</span> <span class="kd">with</span> <span class="nx">$</span><span class="p">{</span><span class="nx">parameter</span><span class="p">}</span><span class="err">`</span>
</code></pre>
</div>

<h3 id="whitespaces">Whitespaces</h3>

<p>Put a single space in front of <code class="highlighter-rouge">(</code> for anything other than a function call</p>

<h3 id="functions-1">Functions</h3>

<p>Use named functions.</p>

<ul>
  <li>always create a new <code class="highlighter-rouge">Error</code> object with your message (<code class="highlighter-rouge">new Error('msg')</code>)</li>
  <li>logging is done using the <a href="https://github.com/npm/npmlog"><code class="highlighter-rouge">npmlog</code></a> utility</li>
</ul>

<h3 id="case-naming-etc">Case, naming, etc</h3>

<ul>
  <li>use <strong>lowerCamelCase</strong> for multiword identifiers when they refer to objects, functions, methods, properties, or anything not specified in this section</li>
  <li>use <strong>UpperCamelCase</strong> for class names (things that you’d pass to “new”)</li>
  <li>use <strong>all-lower-hyphen-css-case</strong> for multiword filenames and config keys</li>
  <li>use named functions, they make stack traces easier to follow</li>
  <li>use <strong>CAPS_SNAKE_CASE</strong> for constants, things that should never change and are rarely used</li>
</ul>

<h3 id="null-undefined-false">null, undefined, false</h3>

<ul>
  <li>boolean variables and functions should always be either <code class="highlighter-rouge">true</code> or <code class="highlighter-rouge">false</code></li>
  <li>when something is intentionally missing or removed, set it to <code class="highlighter-rouge">null</code></li>
  <li>don’t set things to <code class="highlighter-rouge">undefined</code></li>
  <li>boolean objects are verboten</li>
</ul>

<h3 id="exceptions">Exceptions</h3>

<p>For the native Node.js callback usage, never to ever ever throw anything. It’s worse than useless. Just send the error message back as the first argument to the callback.</p>

<p>But for the modern ES 6 promise usage, exceptions are fine.</p>

<h2 id="from-nodejs-modules">From <a href="https://nodejs.org/dist/latest-v6.x/docs/api/modules.html">Node.js modules</a></h2>

<h3 id="modules">Modules</h3>

<p>Modules are a way of preventing multiple JavaScript units to polute the global namespace.</p>

<p>Objects defined at root level in a module are not global, but belong to the module; the usual name for this is <em>module-global</em>.</p>

<h3 id="caching">Caching</h3>

<p>Modules are cached after the first time they are loaded. This means (among other things) that every call to require(‘foo’) will get exactly the same object returned, if it would resolve to the same file. Multiple calls to <code class="highlighter-rouge">require('foo')</code> will not cause the module code to be executed multiple times.</p>

<p>From this point of view, modules behave like <a href="https://en.wikipedia.org/wiki/Singleton_pattern">singletons</a>; they can also be compared to static classes in C++.</p>

<p>Leaving status at the module level can be either a blessing or a curse, depending on the environment used to run the module. In server environments, using module-global variables is like using static variables in a multi-threaded environment, if not handled correctly it may have unexpected results.</p>

<h3 id="exports">Exports</h3>

<p>To make some functions and objects visible outside the module, you can add them as properties to the special <code class="highlighter-rouge">modules.exports</code> object:</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">PI</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">area</span> <span class="o">=</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">PI</span> <span class="o">*</span> <span class="nx">r</span> <span class="o">*</span> <span class="nx">r</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">circumference</span> <span class="o">=</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="nx">PI</span> <span class="o">*</span> <span class="nx">r</span>
</code></pre>
</div>

<p>Although you can rewrite the <code class="highlighter-rouge">module.export</code> to be a sinle function (such as a constructor), still prefer to add them as properties to the object and refer to them explicitly in the <code class="highlighter-rouge">require()</code> line:</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">square</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./square.js'</span><span class="p">).</span><span class="nx">square</span>
<span class="kr">const</span> <span class="nx">mySquare</span> <span class="o">=</span> <span class="nx">square</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="err">`</span><span class="nx">The</span> <span class="nx">area</span> <span class="nx">of</span> <span class="nx">my</span> <span class="nx">square</span> <span class="nx">is</span> <span class="nx">$</span><span class="p">{</span><span class="nx">mySquare</span><span class="p">.</span><span class="nx">area</span><span class="p">()}</span><span class="err">`</span><span class="p">)</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">area</span> <span class="o">=</span> <span class="p">(</span><span class="nx">width</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">area</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">width</span> <span class="o">*</span> <span class="nx">width</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>If you want to export a complete object in one assignment instead of building it one property at a time, assign it to <code class="highlighter-rouge">module.exports</code>.</p>

<h3 id="accessing-the-main-module">Accessing the main module</h3>

<p>When a file is run directly from Node.js, <code class="highlighter-rouge">require.main</code> is set to its module. That means that you can determine whether a file has been run directly by testing</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">require</span><span class="p">.</span><span class="nx">main</span> <span class="o">===</span> <span class="nx">module</span>
</code></pre>
</div>

<h3 id="the-module-wrapper">The module wrapper</h3>

<p>Before a module’s code is executed, Node.js will wrap it with a function wrapper that looks like the following:</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span> <span class="o">=</span> <span class="p">...</span> <span class="c1">// an object for the current module</span>
<span class="nx">module</span><span class="p">.</span><span class="kr">export</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">// an empty object</span>
<span class="nx">exports</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="kr">export</span> <span class="c1">// a reference to the exports; avoid using it</span>
<span class="nx">__filename</span> <span class="o">=</span> <span class="s1">'/x/y/z/abc.js'</span>
<span class="nx">__dirname</span> <span class="o">=</span> <span class="s1">'/x/y/z'</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">require</span><span class="p">,</span> <span class="nx">module</span><span class="p">,</span> <span class="nx">__filename</span><span class="p">,</span> <span class="nx">__dirname</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Your module code actually lives in here</span>
<span class="p">});</span>
</code></pre>
</div>

<p>In each module, the <code class="highlighter-rouge">module</code> variable is a reference to the object representing the current module. <code class="highlighter-rouge">module</code> isn’t actually a global but rather local to each module.</p>

<p>The <code class="highlighter-rouge">module.exports</code> object is created by the Module system. Sometimes this is not acceptable; many want their module to be an object of their own. To do this, assign the desired export object to <code class="highlighter-rouge">module.exports</code>.</p>

<p>For convenience, <code class="highlighter-rouge">module.exports</code> is also accessible via the <code class="highlighter-rouge">exports</code> module-global. Note that assigning a value to <code class="highlighter-rouge">exports</code> will simply rebind the local exports variable, which is probably not what you want to do; if the relationship between <code class="highlighter-rouge">exports</code> and <code class="highlighter-rouge">module.exports</code> seems like magic to you, ignore <code class="highlighter-rouge">exports</code> and only use <code class="highlighter-rouge">module.exports</code>.</p>

<p>Note that assignment to <code class="highlighter-rouge">module.exports</code> must be done immediately. It cannot be done in any callbacks.</p>

<h3 id="global-objects">Global objects</h3>

<p>These are really objects, available in all modules. (see Node.js <a href="https://nodejs.org/api/globals.html">Globals</a>)</p>

<ul>
  <li><code class="highlighter-rouge">global</code></li>
  <li><code class="highlighter-rouge">process</code></li>
  <li><code class="highlighter-rouge">console</code>
    <ul>
      <li><code class="highlighter-rouge">console.log('msg')</code> - writes ‘msg’ to stdout</li>
      <li><code class="highlighter-rouge">console.warn('msg')</code> - writes ‘msg’ to stderr</li>
      <li><code class="highlighter-rouge">console.error('msg')</code> - writes ‘Error: msg’ to stderr</li>
      <li><code class="highlighter-rouge">console.assert(value, 'msg')</code></li>
    </ul>
  </li>
</ul>

<h2 id="the-xpack-project-preferences">The xPack project preferences</h2>

<h3 id="prefer-es6-solutions">Prefer ES6 solutions</h3>

<p>This is Rule no. 1, that overrides all other rules. Definitely <strong>avoid using old style code</strong>.</p>

<h3 id="use-classes-as-much-as-possible">Use classes as much as possible</h3>

<p>Even if the new syntax is mostly syntactic sugar, and internally things behave as strangly as they did in the first JavaScript versions, still <strong>use the new class syntax</strong> at large; it is much cleaner and improves readability.</p>

<h3 id="use-promises-instead-of-callbacks">Use promises instead of callbacks</h3>

<p>Really. No callbacks at all. Use promises.</p>

<h3 id="use-asyncawait-for-anynchronous-calls">Use async/await for anynchronous calls</h3>

<p>Once <code class="highlighter-rouge">async</code>/<code class="highlighter-rouge">await</code> became standard, and the V8 engine added support for them, there is no reason for not using <code class="highlighter-rouge">async</code>/<code class="highlighter-rouge">await</code>.</p>

<p><strong>Wrap old legacy code using callbacks into promises</strong> and execute them with <code class="highlighter-rouge">await</code>.</p>

<h3 id="use-static-class-members-for-sharing">Use static class members for sharing</h3>

<p>Modules are singletons; using module variables is like using static variables in a multi-threaded environment; they may provide a way of sharing common data between multiple instances of objects created inside the same module, but if not handled correctly this may have unexpected results.</p>

<p>The general recommendation is to <strong>make the modules reentrant</strong>. In practical terms, <strong>do not use module-global variables</strong> at all; make the module <strong>export a class, and create instances of it</strong> whenever needed; for sharing data between instances, <strong>use static class members</strong>.</p>

<h3 id="do-not-restrict-export-to-a-single-function-or-class">Do not restrict export to a single function or class</h3>

<p>Bad style:</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
	<span class="k">return</span> <span class="sr">/</span><span class="se">[\u</span><span class="sr">001b</span><span class="se">\u</span><span class="sr">009b</span><span class="se">][</span><span class="sr">[()#;?</span><span class="se">]</span><span class="sr">*</span><span class="se">(?:[</span><span class="sr">0-9</span><span class="se">]{1,4}(?:</span><span class="sr">;</span><span class="se">[</span><span class="sr">0-9</span><span class="se">]{0,4})</span><span class="sr">*</span><span class="se">)?[</span><span class="sr">0-9A-ORZcf-nqry=&gt;&lt;</span><span class="se">]</span><span class="sr">/g</span><span class="p">;</span>
<span class="p">};</span>
<span class="p">...</span>
<span class="kr">const</span> <span class="nx">func</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span>
</code></pre>
</div>

<p>Apart from being unnamed, returning a single function prevents future extensions, for example exporting a second function from the same module would mandate all modules that use the first function via <code class="highlighter-rouge">require()</code> to be updated to <code class="highlighter-rouge">require().func1</code>, which may cause many headaches to developers.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">func1</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
	<span class="k">return</span> <span class="sr">/</span><span class="se">[\u</span><span class="sr">001b</span><span class="se">\u</span><span class="sr">009b</span><span class="se">][</span><span class="sr">[()#;?</span><span class="se">]</span><span class="sr">*</span><span class="se">(?:[</span><span class="sr">0-9</span><span class="se">]{1,4}(?:</span><span class="sr">;</span><span class="se">[</span><span class="sr">0-9</span><span class="se">]{0,4})</span><span class="sr">*</span><span class="se">)?[</span><span class="sr">0-9A-ORZcf-nqry=&gt;&lt;</span><span class="se">]</span><span class="sr">/g</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">func2</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
<span class="p">...</span>
<span class="kr">const</span> <span class="nx">func</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'name'</span><span class="p">).</span><span class="nx">func1</span>
</code></pre>
</div>

<p>The recommendation is to always return functions or preferably classes as properties of the <code class="highlighter-rouge">module.exports</code> object, and get them individually by name.</p>

<h3 id="prefer-static-classes-to-group-methods">Prefer static classes to group methods</h3>

<p>Prepare your module to export multiple functions; group them (by functionality) either below a parent object, or, even better, in classes with static members.</p>

<p>The main advantage of this scheme is that adding new exports will only change the interface incrementaly, minimising the risk to break backward compatibility.</p>

<h2 id="make-node-exportsimports-look-like-es6-exportsimports">Make node exports/imports look like ES6 exports/imports</h2>

<p>Assuming classes are prefered, the EC6 syntax for export/import would look like:</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">export</span> <span class="kr">class</span> <span class="nx">WscriptAvoider</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
<span class="p">...</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">WscriptAvoider</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'wscript-avoider.js'</span>
</code></pre>
</div>

<p>So, to stay close to this syntax, the recommendation is to preserve the original <code class="highlighter-rouge">module.exports</code> object, and add properties to it, preferably classes, even if they have only static members.</p>

<p>To import them, the syntax uses the explicit classs name:</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">WscriptAvoider</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'wscript-avoider'</span><span class="p">).</span><span class="nx">WscriptAvoider</span>
<span class="nx">WscriptAvoider</span><span class="p">.</span><span class="nx">quitIfWscript</span><span class="p">(</span><span class="nx">appName</span><span class="p">)</span>
</code></pre>
</div>

<p>Cases like <code class="highlighter-rouge">import { WscriptAvoider as Xyz } from 'wscript-avoider.js'</code> would be naturaly represented as:</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">Xyz</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'wscript-avoider'</span><span class="p">).</span><span class="nx">WscriptAvoider</span>
<span class="nx">Xyz</span><span class="p">.</span><span class="nx">quitIfWscript</span><span class="p">(</span><span class="nx">appName</span><span class="p">)</span>
</code></pre>
</div>

<p>In case the class is not static, instantiate it as usual.</p>

<h2 id="links-to-other-style-guides">Links to other style guides</h2>

<p>Prefered:</p>

<ul>
  <li><a href="https://standardjs.com">JavaScript “Standard” Style</a></li>
</ul>

<p>Other links:</p>

<ul>
  <li><a href="http://noeticforce.com/best-javascript-style-guide-for-maintainable-code">10 Best JavaScript Style Guides</a></li>
  <li><a href="https://github.com/airbnb/javascript">airbnb JavaScript Style Guide</a></li>
  <li><a href="https://github.com/rwaldron/idiomatic.js/">Idiomatic.js JavaScript Style Guide</a></li>
  <li><a href="https://google.github.io/styleguide/jsguide.html">Google ES6 Style Guide</a></li>
  <li><a href="http://javascript.crockford.com/code.html">Crockford Code Conventions for the JavaScript Programming Language</a></li>
  <li><a href="https://github.com/felixge/node-style-guide">felixge/node-style-guide</a></li>
  <li><a href="https://github.com/RisingStack/node-style-guide">RisingStack/node-style-guide</a></li>
</ul>

<h2 id="linting-tools">Linting Tools</h2>

<p>Prefered (used automatically by Standard):</p>

<ul>
  <li><a href="http://eslint.org/">ESLint</a>, but indirectly via the ‘Standard JS’ tools.</li>
</ul>

<p>Other links:</p>

<ul>
  <li><a href="https://www.sitepoint.com/comparison-javascript-linting-tools/">A Comparison of JavaScript Linting Tools</a></li>
  <li><a href="http://www.jshint.com/">JSHint</a></li>
</ul>








<ul class="share-buttons">
  <li><div class="fb-share-button" data-href="/develop/js-style-guide/" data-layout="button"></div></li>
  <li><div class="tw-share-button"><a href="https://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a></div></li>
</ul>



      </div>

    </div>
  </div>

</div>

<div class="container">

  <div class="site-footer">
  <div class="site-footer-links left">
    <ul>
  <li>© 2017 Liviu Ionescu</li>
  <li>Hosted on GitHub</li>
  <li><a href="/feed.xml"><img src="/assets/images/feed-20.png" alt="RSS" /></a></li>
</ul>


  </div>
  <a href="https://github.com/xcdl/xcdl-js" aria-label="Homepage">
      <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
  </a>
  <div class="site-footer-links right">
    <ul>
  <li><a href="/">Home</a></li>
  <li><a href="/blog/">News</a></li>
  <li><a href="https://github.com/xcdl/xcdl-js/releases">Releases</a></li>
  <li><a href="https://github.com/xcdl/xcdl-js/issues">Support</a></li>
  <li><a href="/about/">About</a></li>
</ul>

  </div>
</div>


</div>

</body>
</html>
